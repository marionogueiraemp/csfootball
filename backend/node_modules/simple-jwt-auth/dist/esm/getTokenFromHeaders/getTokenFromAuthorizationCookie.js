/* eslint-disable @typescript-eslint/naming-convention */
import { isJSONWebToken } from '../isJSONWebToken';
export const getTokenFromAuthorizationCookie = ({ headers, }) => {
    var _a, _b, _c;
    // grab the authorization cookie field
    const cookies = (_b = (_a = headers.cookie) !== null && _a !== void 0 ? _a : headers.Cookie) !== null && _b !== void 0 ? _b : null; // headers are case-insensitive, by spec: https://stackoverflow.com/a/5259004/3068233
    if (!cookies)
        return null;
    const [_, authorization] = (_c = new RegExp(/ (authorization=[a-zA-Z0-9\-_.]+);/i).exec(` ${cookies};`)) !== null && _c !== void 0 ? _c : [];
    if (!authorization)
        return null; // auth cookie not found
    const potentiallyAToken = authorization.replace(/^authorization=/, ''); // case sensitive: https://stackoverflow.com/a/11312272/3068233
    if (!isJSONWebToken(potentiallyAToken))
        return null; // check that it looks like a token, since other strings can be passed here
    return potentiallyAToken;
};
//# sourceMappingURL=getTokenFromAuthorizationCookie.js.map