import { isJSONWebToken } from '../isJSONWebToken';
export const getTokenFromAuthorizationHeader = ({ headers, }) => {
    var _a, _b;
    // grab the authorization header field
    const authorization = (_b = (_a = headers.authorization) !== null && _a !== void 0 ? _a : headers.Authorization) !== null && _b !== void 0 ? _b : null; // headers are case-insensitive, by spec: https://stackoverflow.com/a/5259004/3068233
    if (!authorization)
        return null;
    const potentiallyAToken = authorization.replace(/^Bearer /i, '');
    if (!isJSONWebToken(potentiallyAToken))
        return null; // check that it looks like a token, since other strings can be passed here
    return potentiallyAToken;
};
//# sourceMappingURL=getTokenFromAuthorizationHeader.js.map