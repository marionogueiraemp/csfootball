"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.redactSignature = void 0;
const SimpleJwtAuthError_1 = require("./SimpleJwtAuthError");
const isJSONWebToken_1 = require("./isJSONWebToken");
/**
 * a simple method which redacts the signature from a token to make it unauthenticatable - but still capable of having unauthed claims extracted
 *
 * this allows the claims of the token to be shared publicly and used in insecure and vulnerable environments (e.g., websites), without risking giving an attacker the ability to make authenticated requests with these claims (e.g., through XSS)
 */
const redactSignature = ({ token }) => {
    if (!(0, isJSONWebToken_1.isJSONWebToken)(token))
        throw new SimpleJwtAuthError_1.SimpleJwtAuthError('token does not match shape of a JWT');
    return [...token.split('.').slice(0, 2), '__REDACTED__'].join('.');
};
exports.redactSignature = redactSignature;
//# sourceMappingURL=redactSignature.js.map