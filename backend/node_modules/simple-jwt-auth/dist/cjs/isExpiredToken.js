"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.isExpiredToken = exports.isAfter = exports.isBefore = exports.fromUnixTime = void 0;
const getUnauthedClaims_1 = require("./getUnauthedClaims");
// define basic date manipulation fns (dont import from a third party lib to decrease bundle size; this stuff is really basic too)
const fromUnixTime = (seconds) => new Date(seconds * 1000);
exports.fromUnixTime = fromUnixTime;
const isBefore = (referenceDate, comparisonDate) => referenceDate.getTime() < comparisonDate.getTime();
exports.isBefore = isBefore;
const isAfter = (referenceDate, comparisonDate) => referenceDate.getTime() > comparisonDate.getTime();
exports.isAfter = isAfter;
/**
 * check whether the token is expired
 */
const isExpiredToken = (token) => {
    const now = new Date();
    const unauthedClaims = (0, getUnauthedClaims_1.getUnauthedClaims)({ token });
    return (0, exports.isAfter)(now, (0, exports.fromUnixTime)(unauthedClaims.exp));
};
exports.isExpiredToken = isExpiredToken;
//# sourceMappingURL=isExpiredToken.js.map