"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getUnauthedClaims = void 0;
const SimpleJwtAuthError_1 = require("./SimpleJwtAuthError");
const base64UrlDecode_1 = require("./base64Url/base64UrlDecode");
const isJSONWebToken_1 = require("./isJSONWebToken");
/**
 * Decode the body of the token and return the claims, without checking authenticity of claims.
 */
const getUnauthedClaims = ({ token, }) => {
    if (!(0, isJSONWebToken_1.isJSONWebToken)(token))
        throw new SimpleJwtAuthError_1.SimpleJwtAuthError('token does not match shape of a JWT');
    const parts = token.split('.');
    const payload = JSON.parse((0, base64UrlDecode_1.base64UrlDecode)(parts[1]));
    return payload;
};
exports.getUnauthedClaims = getUnauthedClaims;
//# sourceMappingURL=getUnauthedClaims.js.map