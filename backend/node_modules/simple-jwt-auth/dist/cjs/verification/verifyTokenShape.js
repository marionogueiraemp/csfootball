"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.verifyTokenShape = void 0;
const isJSONWebToken_1 = require("../isJSONWebToken");
const JwtVerificationError_1 = require("./JwtVerificationError");
/**
 * throw an error if token does not have proper shape
 *
 * protects the code against malformed input - but may also potentially protect against vulnerabilities
 */
const verifyTokenShape = ({ token }) => {
    if (!(0, isJSONWebToken_1.isJSONWebToken)(token))
        throw new JwtVerificationError_1.JwtVerificationError({
            reason: 'token does not match shape of a JWT',
        });
};
exports.verifyTokenShape = verifyTokenShape;
//# sourceMappingURL=verifyTokenShape.js.map