"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getTokenFromAuthorizationHeader = void 0;
const isJSONWebToken_1 = require("../isJSONWebToken");
const getTokenFromAuthorizationHeader = ({ headers, }) => {
    var _a, _b;
    // grab the authorization header field
    const authorization = (_b = (_a = headers.authorization) !== null && _a !== void 0 ? _a : headers.Authorization) !== null && _b !== void 0 ? _b : null; // headers are case-insensitive, by spec: https://stackoverflow.com/a/5259004/3068233
    if (!authorization)
        return null;
    const potentiallyAToken = authorization.replace(/^Bearer /i, '');
    if (!(0, isJSONWebToken_1.isJSONWebToken)(potentiallyAToken))
        return null; // check that it looks like a token, since other strings can be passed here
    return potentiallyAToken;
};
exports.getTokenFromAuthorizationHeader = getTokenFromAuthorizationHeader;
//# sourceMappingURL=getTokenFromAuthorizationHeader.js.map