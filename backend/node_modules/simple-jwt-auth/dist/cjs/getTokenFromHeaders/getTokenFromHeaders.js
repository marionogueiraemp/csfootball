"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getTokenFromHeaders = void 0;
const SimpleJwtAuthError_1 = require("../SimpleJwtAuthError");
const getTokenFromAuthorizationCookieWithCSRFProtection_1 = require("./getTokenFromAuthorizationCookieWithCSRFProtection");
const getTokenFromAuthorizationHeader_1 = require("./getTokenFromAuthorizationHeader");
const getTokenFromHeaders = ({ headers, }) => {
    // sanity check that headers are actually defined; otherwise, developer probably is not using this function correctly - so fail fast
    if (!headers)
        throw new SimpleJwtAuthError_1.SimpleJwtAuthError('headers must be defined to getTokenFromHeaders');
    // try to grab the token from auth cookie (w/ CSRF protection)
    const tokenFromAuthCookie = (0, getTokenFromAuthorizationCookieWithCSRFProtection_1.getTokenFromAuthorizationCookieWithCSRFProtection)({ headers });
    if (tokenFromAuthCookie)
        return tokenFromAuthCookie;
    // try to grab the token from auth header
    const tokenFromAuthHeader = (0, getTokenFromAuthorizationHeader_1.getTokenFromAuthorizationHeader)({ headers });
    if (tokenFromAuthHeader)
        return tokenFromAuthHeader;
    // if neither worked, return null
    return null;
};
exports.getTokenFromHeaders = getTokenFromHeaders;
//# sourceMappingURL=getTokenFromHeaders.js.map