"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.getPublicKeyFromCache = exports.cachePublicKey = void 0;
const simple_in_memory_cache_1 = require("simple-in-memory-cache");
const publicKeyCache = (0, simple_in_memory_cache_1.createCache)({ defaultSecondsUntilExpiration: 5 * 60 }); // cache public keys for up to 5 min
const cachePublicKey = ({ issuer, keyId, publicKey, ttlInSeconds, }) => publicKeyCache.set(`${issuer}:${keyId}`, publicKey, {
    secondsUntilExpiration: ttlInSeconds,
});
exports.cachePublicKey = cachePublicKey;
const getPublicKeyFromCache = ({ issuer, keyId, }) => publicKeyCache.get(`${issuer}:${keyId}`);
exports.getPublicKeyFromCache = getPublicKeyFromCache;
//# sourceMappingURL=publicKeyCache.js.map